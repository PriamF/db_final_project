version: 2

models:
  - name: mrt_orders_enrich
    description: "This model aggregates information from orders, customers, stores, staff, and order sales to provide a holistic view of sales performance for Local Bike."
    columns:
      - name: order_id
        description: "Primary key, unique identifier for each order. Aggregated from the 'orders' table."
        tests:
          - unique
          - not_null
      - name: customer_id
        description: "Foreign key linking the order to the corresponding customer."
        tests:
          - relationships:
              name: customer_id_foreign_key_in_sales_analytics
              to: ref('stg_customers')
              field: customer_id
      - name: order_date
        description: "The date when the order was placed."
      - name: order_sales
        description: "The total revenue generated by the order, calculated as (list_price * (1 - discount) * quantity)."
      - name: quantity
        description: "The total quantity of items in the order."
      - name: store_id
        description: "Foreign key linking the order to the store where it was placed."
        tests:
          - relationships:
              name: store_id_foreign_key_in_sales_analytics
              to: ref('stg_stores')
              field: store_id
      - name: store_name
        description: "The name of the store where the order was placed."
      - name: store_city
        description: "The city where the store is located."
      - name: store_state
        description: "The state where the store is located."
      - name: customer_name
        description: "The full name of the customer, concatenated from first_name and last_name."
      - name: customer_city
        description: "The city where the customer resides."
      - name: customer_state
        description: "The state where the customer resides."
      - name: staff_id
        description: "Foreign key linking the order to the staff member responsible for the sale."
        tests:
          - relationships:
              name: staff_id_foreign_key_in_sales_analytics
              to: ref('stg_staffs')
              field: staff_id
      - name: staff_name
        description: "The full name of the staff member responsible for the sale, concatenated from first_name and last_name."